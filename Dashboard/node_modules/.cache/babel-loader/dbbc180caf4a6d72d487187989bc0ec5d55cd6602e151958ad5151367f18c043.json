{"ast":null,"code":"var _jsxFileName = \"/Users/ricardosilva/Desktop/Projeto/Dashboard/src/contexts/ReveosDataContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ReveosDataContext = /*#__PURE__*/createContext();\nexport function ReveosDataProvider({\n  children\n}) {\n  _s();\n  const [cache, setCache] = useState({\n    data: null,\n    timestamp: null,\n    loading: false,\n    promise: null\n  });\n  const CACHE_DURATION = 5 * 60 * 1000; // 5 minutos em millisegundos\n\n  const fetchData = async () => {\n    const token = localStorage.getItem(\"authToken\");\n    const apiUrl = process.env.REACT_APP_API_URL;\n    if (!token) {\n      throw new Error(\"Nenhum token de autenticação encontrado\");\n    }\n    const response = await fetch(`${apiUrl}/api/reveosComponentsVolume`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`\n      }\n    });\n    if (!response.ok) {\n      if (response.status === 401 || response.status === 403) {\n        localStorage.removeItem(\"authToken\");\n        window.location.href = \"/authentication/sign-in\";\n        return null;\n      }\n      throw new Error(`Erro HTTP: ${response.status}`);\n    }\n    const data = await response.json();\n    return data;\n  };\n  const getData = async () => {\n    const now = Date.now();\n\n    // Se temos dados em cache e eles ainda são válidos\n    if (cache.data && cache.timestamp && now - cache.timestamp < CACHE_DURATION) {\n      return cache.data;\n    }\n\n    // Se já existe uma requisição em andamento, retorna a promise existente\n    if (cache.loading && cache.promise) {\n      return cache.promise;\n    }\n\n    // Inicia nova requisição\n    setCache(prev => ({\n      ...prev,\n      loading: true\n    }));\n    const promise = fetchData().then(data => {\n      setCache({\n        data,\n        timestamp: Date.now(),\n        loading: false,\n        promise: null\n      });\n      return data;\n    }).catch(error => {\n      setCache(prev => ({\n        ...prev,\n        loading: false,\n        promise: null\n      }));\n      throw error;\n    });\n    setCache(prev => ({\n      ...prev,\n      promise\n    }));\n    return promise;\n  };\n  return /*#__PURE__*/_jsxDEV(ReveosDataContext.Provider, {\n    value: {\n      getData\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 10\n  }, this);\n}\n_s(ReveosDataProvider, \"35kGSAzwz1MXX5KG1xLab9H14tE=\");\n_c = ReveosDataProvider;\nexport function useReveosData() {\n  _s2();\n  return useContext(ReveosDataContext);\n}\n_s2(useReveosData, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"ReveosDataProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","jsxDEV","_jsxDEV","ReveosDataContext","ReveosDataProvider","children","_s","cache","setCache","data","timestamp","loading","promise","CACHE_DURATION","fetchData","token","localStorage","getItem","apiUrl","process","env","REACT_APP_API_URL","Error","response","fetch","method","headers","Authorization","ok","status","removeItem","window","location","href","json","getData","now","Date","prev","then","catch","error","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useReveosData","_s2","$RefreshReg$"],"sources":["/Users/ricardosilva/Desktop/Projeto/Dashboard/src/contexts/ReveosDataContext.js"],"sourcesContent":["import React, { createContext, useContext, useState } from \"react\";\n\nconst ReveosDataContext = createContext();\n\nexport function ReveosDataProvider({ children }) {\n  const [cache, setCache] = useState({\n    data: null,\n    timestamp: null,\n    loading: false,\n    promise: null,\n  });\n\n  const CACHE_DURATION = 5 * 60 * 1000; // 5 minutos em millisegundos\n\n  const fetchData = async () => {\n    const token = localStorage.getItem(\"authToken\");\n    const apiUrl = process.env.REACT_APP_API_URL;\n\n    if (!token) {\n      throw new Error(\"Nenhum token de autenticação encontrado\");\n    }\n\n    const response = await fetch(`${apiUrl}/api/reveosComponentsVolume`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      if (response.status === 401 || response.status === 403) {\n        localStorage.removeItem(\"authToken\");\n        window.location.href = \"/authentication/sign-in\";\n        return null;\n      }\n      throw new Error(`Erro HTTP: ${response.status}`);\n    }\n\n    const data = await response.json();\n    return data;\n  };\n\n  const getData = async () => {\n    const now = Date.now();\n\n    // Se temos dados em cache e eles ainda são válidos\n    if (cache.data && cache.timestamp && now - cache.timestamp < CACHE_DURATION) {\n      return cache.data;\n    }\n\n    // Se já existe uma requisição em andamento, retorna a promise existente\n    if (cache.loading && cache.promise) {\n      return cache.promise;\n    }\n\n    // Inicia nova requisição\n    setCache((prev) => ({ ...prev, loading: true }));\n    const promise = fetchData()\n      .then((data) => {\n        setCache({\n          data,\n          timestamp: Date.now(),\n          loading: false,\n          promise: null,\n        });\n        return data;\n      })\n      .catch((error) => {\n        setCache((prev) => ({ ...prev, loading: false, promise: null }));\n        throw error;\n      });\n\n    setCache((prev) => ({ ...prev, promise }));\n    return promise;\n  };\n\n  return <ReveosDataContext.Provider value={{ getData }}>{children}</ReveosDataContext.Provider>;\n}\n\nexport function useReveosData() {\n  return useContext(ReveosDataContext);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}